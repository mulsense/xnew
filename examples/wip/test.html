<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <script src="../dist/xnew.js"></script>
  <style>


    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
      background: #f5f5f5;
    }
  </style>
</head>

<body>
  <div id="main" style="width: 100%; height: 100%;"></div>
  <script>

    xnew('#main', () => {
      xnew(HamburgerMenu);
    });

    function HamburgerMenu(self) {
      let isOpen = false;
      let isMobile = false;
      let isSmallMobile = false;
      let isTablet = false;

      // Check screen size
      function checkScreenSize() {
        const width = window.innerWidth;
        isSmallMobile = width <= 480;
        isMobile = width <= 768;
        isTablet = width > 768 && width <= 1024;
        return { isMobile, isSmallMobile, isTablet };
      }

      // Apply styles helper
      function applyStyles(element, styles) {
        Object.assign(element.style, styles);
      }

      // Create overlay
      const overlay = xnew('<div>');
      const overlayStyles = {
        position: 'fixed',
        top: '0',
        left: '0',
        width: '100%',
        height: '100%',
        background: 'rgba(0, 0, 0, 0.5)',
        opacity: '0',
        visibility: 'hidden',
        transition: 'all 0.3s ease',
        zIndex: '999'
      };
      applyStyles(overlay.element, overlayStyles);

      // Create menu container
      const menu = xnew('<div>');
      const baseMenuStyles = {
        position: 'fixed',
        top: '0',
        right: '0',
        height: '100vh',
        boxShadow: '-2px 0 10px rgba(0, 0, 0, 0.1)',
        transform: 'translateX(100%)',
        transition: 'transform 0.3s ease',
        zIndex: '1000',
        overflowY: 'auto'
      };
      applyStyles(menu.element, baseMenuStyles);

      // Create hamburger button
      const hamburger = xnew('<div>');
      const baseHamburgerStyles = {
        position: 'fixed',
        background: '#333',
        borderRadius: '8px',
        cursor: 'pointer',
        zIndex: '1001',
        display: 'flex',
        flexDirection: 'column',
        justifyContent: 'center',
        alignItems: 'center',
        transition: 'background 0.3s ease'
      };
      applyStyles(hamburger.element, baseHamburgerStyles);

      // Create hamburger lines
      const lines = [];
      for (let i = 0; i < 3; i++) {
        const line = xnew(hamburger.element, (self) => {
          xnew.nest('<div>');
        });
        const lineStyles = {
          background: 'white',
          borderRadius: '2px',
          transition: 'all 0.3s ease'
        };
        applyStyles(line.element, lineStyles);
        lines.push(line);
      }

      // Menu items data
      const menuItemsData = ['Home', 'About', 'Services', 'Portfolio', 'Blog', 'Contact'];
      const menuItems = [];

      // Create menu items
      menuItemsData.forEach(item => {
        const menuItem = xnew(menu.element, (self) => {
          xnew.nest('<div>');
          self.element.textContent = item;
        });
        const itemStyles = {
          cursor: 'pointer',
          transition: 'all 0.2s ease'
        };
        applyStyles(menuItem.element, itemStyles);

        menuItem.on('click', () => {
          console.log(`Clicked: ${item}`);
          toggleMenu();
        });

        // Hover effects
        menuItem.on('mouseenter', () => {
          if (isMobile) {
            menuItem.element.style.background = 'rgba(255, 255, 255, 0.15)';
            menuItem.element.style.transform = 'scale(1.02)';
          } else {
            menuItem.element.style.color = '#007bff';
            menuItem.element.style.paddingLeft = '10px';
          }
        });

        menuItem.on('mouseleave', () => {
          if (isMobile) {
            menuItem.element.style.background = '';
            menuItem.element.style.transform = '';
          } else {
            menuItem.element.style.color = '';
            menuItem.element.style.paddingLeft = '';
          }
        });

        menuItems.push(menuItem);
      });

      // Update responsive styles
      function updateResponsiveStyles() {
        const screen = checkScreenSize();

        // Hamburger styles
        if (screen.isSmallMobile) {
          applyStyles(hamburger.element, {
            top: '10px',
            right: '10px',
            width: '40px',
            height: '40px',
            gap: '5px'
          });
          lines.forEach(line => {
            applyStyles(line.element, { width: '25px', height: '2.5px' });
          });
        } else if (screen.isMobile) {
          applyStyles(hamburger.element, {
            top: '15px',
            right: '15px',
            width: '45px',
            height: '45px',
            gap: '6px'
          });
          lines.forEach(line => {
            applyStyles(line.element, { width: '30px', height: '3px' });
          });
        } else {
          applyStyles(hamburger.element, {
            top: '20px',
            right: '20px',
            width: '50px',
            height: '50px',
            gap: '6px'
          });
          lines.forEach(line => {
            applyStyles(line.element, { width: '30px', height: '3px' });
          });
        }

        // Menu styles
        if (screen.isSmallMobile) {
          applyStyles(menu.element, {
            width: '100%',
            padding: '80px 15px 20px',
            background: 'linear-gradient(135deg, #667eea 0%, #764ba2 100%)'
          });
        } else if (screen.isMobile) {
          applyStyles(menu.element, {
            width: '100%',
            padding: '100px 20px 30px',
            background: 'linear-gradient(135deg, #667eea 0%, #764ba2 100%)'
          });
        } else if (screen.isTablet) {
          applyStyles(menu.element, {
            width: '350px',
            padding: '90px 35px 30px',
            background: '#fff'
          });
        } else {
          applyStyles(menu.element, {
            width: '300px',
            padding: '80px 30px 30px',
            background: '#fff'
          });
        }

        // Menu item styles
        menuItems.forEach(menuItem => {
          if (screen.isSmallMobile) {
            applyStyles(menuItem.element, {
              padding: '18px 12px',
              fontSize: '20px',
              color: '#fff',
              borderBottom: '1px solid rgba(255, 255, 255, 0.2)',
              borderRadius: '8px',
              marginBottom: '8px',
              textAlign: 'center',
              fontWeight: '500',
              letterSpacing: '0.5px'
            });
          } else if (screen.isMobile) {
            applyStyles(menuItem.element, {
              padding: '20px 15px',
              fontSize: '22px',
              color: '#fff',
              borderBottom: '1px solid rgba(255, 255, 255, 0.2)',
              borderRadius: '8px',
              marginBottom: '10px',
              textAlign: 'center',
              fontWeight: '500',
              letterSpacing: '0.5px'
            });
          } else if (screen.isTablet) {
            applyStyles(menuItem.element, {
              padding: '18px 5px',
              fontSize: '20px',
              color: '#333',
              borderBottom: '1px solid #eee',
              borderRadius: '0',
              marginBottom: '0',
              textAlign: 'left',
              fontWeight: 'normal',
              letterSpacing: 'normal'
            });
          } else {
            applyStyles(menuItem.element, {
              padding: '15px 0',
              fontSize: '18px',
              color: '#333',
              borderBottom: '1px solid #eee',
              borderRadius: '0',
              marginBottom: '0',
              textAlign: 'left',
              fontWeight: 'normal',
              letterSpacing: 'normal'
            });
          }
        });

        // Overlay active styles
        if (isOpen) {
          if (screen.isMobile) {
            overlay.element.style.background = 'rgba(0, 0, 0, 0.8)';
          } else {
            overlay.element.style.background = 'rgba(0, 0, 0, 0.5)';
          }
        }
      }

      // Initial responsive setup
      updateResponsiveStyles();

      // Toggle function
      function toggleMenu() {
        isOpen = !isOpen;
        const screen = checkScreenSize();

        if (isOpen) {
          // Open animation
          menu.element.style.transform = 'translateX(0)';
          overlay.element.style.opacity = '1';
          overlay.element.style.visibility = 'visible';

          if (screen.isMobile) {
            overlay.element.style.background = 'rgba(0, 0, 0, 0.8)';
            hamburger.element.style.background = '#667eea';
          }

          // Hamburger lines to X
          lines[0].element.style.transform = 'translateY(9px) rotate(45deg)';
          lines[1].element.style.opacity = '0';
          lines[1].element.style.transform = 'translateX(-20px)';
          lines[2].element.style.transform = 'translateY(-9px) rotate(-45deg)';
        } else {
          // Close animation
          menu.element.style.transform = 'translateX(100%)';
          overlay.element.style.opacity = '0';
          overlay.element.style.visibility = 'hidden';
          hamburger.element.style.background = '#333';

          // X to hamburger lines
          lines[0].element.style.transform = '';
          lines[1].element.style.opacity = '1';
          lines[1].element.style.transform = '';
          lines[2].element.style.transform = '';
        }
      }

      // Hamburger hover effect
      hamburger.on('mouseenter', () => {
        if (!isOpen) {
          hamburger.element.style.background = '#555';
        }
      });

      hamburger.on('mouseleave', () => {
        if (!isOpen) {
          hamburger.element.style.background = '#333';
        }
      });

      // Event listeners
      hamburger.on('click', toggleMenu);
      overlay.on('click', toggleMenu);

      // Resize listener
      xnew.listener(window).on('resize', () => {
        updateResponsiveStyles();
      });

      // Close menu on Escape key
      const keyListener = xnew.listener(window);
      keyListener.on('keydown', (event) => {
        if (event.key === 'Escape' && isOpen) {
          toggleMenu();
        }
      });
    }

    function PageContent(self) {
      xnew.nest('<div class="content">');

      xnew('<h1>', 'Hamburger Menu Demo');
      xnew('<p>', 'Click the hamburger icon in the top-right corner to open the menu.');
      xnew('<p>', 'This is a modern, responsive hamburger menu built with the xnew library. The menu slides in from the right side with smooth animations.');
      xnew('<p>', 'Features:');
      xnew.nest('<ul style="margin-left: 20px; color: #666; line-height: 1.8;">');
      xnew('<li>', 'Smooth slide-in animation');
      xnew('<li>', 'Hamburger icon transforms to X when active');
      xnew('<li>', 'Semi-transparent overlay');
      xnew('<li>', 'Click outside or press Escape to close');
      xnew('<li>', 'Hover effects on menu items');
      xnew('<li>', 'Fully responsive design');
    }

  </script>
</body>

</html>